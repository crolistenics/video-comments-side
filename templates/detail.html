{% extends "base.html" %}
{% block content %}
<div class="d-flex detail-container">
  <div class="video-left">
    <video id="player" controls playsinline style="width:100%">
      <source src="{{ url_for('uploaded_file', filename=video.filename) }}" />
      Your browser does not support HTML5 video.
    </video>

    <div class="mt-3">
      <div class="thumbnail-large position-relative">
        <img id="thumb-img" src="{{ url_for('thumbnail_file', filename=video.thumbnail) }}" alt="thumb" />
        <div id="thumb-overlay" class="overlay-text-large">{{ video.overlay_text }}</div>
      </div>
      <div class="mt-2 d-flex gap-2">
        <a class="btn btn-outline-secondary" href="{{ url_for('download_video', video_id=video.id) }}"><i class="fa fa-download"></i> Download</a>
        <button id="delete-btn" class="btn btn-danger"><i class="fa fa-trash"></i> Delete</button>
      </div>
    </div>
  </div>

  <div class="editor-right">
    <div class="mb-2">
      <label class="form-label">Title</label>
      <input id="title-input" class="form-control" value="{{ video.title }}" />
    </div>

    <label class="form-label">Overlay text (Vim keybindings enabled)</label>
    <div id="editor" style="height:60vh;border:1px solid #ddd;"></div>

    <div class="mt-2 d-flex gap-2">
      <button id="save-btn" class="btn btn-primary"><i class="fa fa-save"></i> Save</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('index') }}">Back</a>
    </div>
  </div>
</div>

<script>
  const VIDEO_ID = {{ video.id }};
  const INITIAL_OVERLAY = {{ (video.overlay_text | tojson) }};
  const INITIAL_TITLE = {{ (video.title | tojson) }};
</script>
<script src="{{ url_for('static', filename='detail.js') }}"></script>
{% endblock %}
